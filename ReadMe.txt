To run the code:
Run the .py files in the following manner:
1. Any model file vgg19.py/resnetkeras2.py (specify the path to the weight file for ResNet152 after downloading it from: https://drive.google.com/file/d/1K4jCjdIoUXqFNy2kiQUXvZICz7upmJj_/view?usp=sharing)
2. Then, run the respective data preparation files prepare_dataset.py/prepare_dataset_resnet.py
3. Run the train_model.py. Specify import caption_generator_lstm for LSTM, caption_generator_blstm for Bidirectional LSTM, caption_generator_gru for GRU, caption_generator_multiLSTM for multi-layer LSTM
4. Run the test_model.py and the final updated weight improvement file generated by train_model.py has to be used

NB. To toggle between the softmax layer and the penultimate layer just comment out the last 3 lines of the respective model files (vgg19.py and resnetkeras2.py).